<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A guide to measuring long-term inequality in the exposure to crime at micro-area levels using `'Akmedoids'` package • akmedoids</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A guide to measuring long-term inequality in the exposure to crime at micro-area levels using `'Akmedoids'` package">
<meta property="og:description" content="akmedoids">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">akmedoids</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/akmedoids-vignette.html">A guide to measuring long-term inequality in the exposure to crime at micro-area levels using `'Akmedoids'` package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MAnalytics/akmedoids/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="akmedoids-vignette_files/header-attrs-2.9/header-attrs.js"></script><script src="akmedoids-vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="akmedoids-vignette_files/kePrint-0.0.1/kePrint.js"></script><link href="akmedoids-vignette_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A guide to measuring long-term inequality in the exposure to crime at micro-area levels using <code>'Akmedoids'</code> package</h1>
                        <h4 class="author"><div class="line-block">
<code>Authors:</code><br><code>Adepeju, M., Langton, S., and Bannister, J.</code><br><code>Big Data Centre, Manchester Metropolitan University, Manchester, M15 6BH</code>
</div></h4>
            
            <h4 class="date"><div class="line-block">
<code>Date:</code><br><code>2021-08-25</code>
</div></h4>
      
      <small class="dont-index">Source: <a href="https://github.com/MAnalytics/akmedoids/blob/master/vignettes/akmedoids-vignette.Rmd"><code>vignettes/akmedoids-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>akmedoids-vignette.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      The <code>'akmedoids'</code> package advances a set of R-functions for longitudinal clustering of long-term trajectories and determines the optimal solution based on the <code>Caliński-Harabasz</code> criterion (Caliński and Harabasz 1974). The package also includes a set of functions for addressing common data issues, such as missing entries and outliers, prior to conducting advance longitudinal data analysis. One of the key objectives of this package is to facilitate easy replication of a recent paper which examined small area inequality in the crime drop (see Adepeju et al. 2021). This document is created to provide a guide towards accomplishing this objective. Many of the functions provided in the <code>akmedoids</code> package may be applied to longitudinal data in general.
    </div>
    
<style type="text/css">

h1.title {
  font-size: 26px;
  line-height: 130%;
  color: Black;
  text-align: center;
}

h2.subtitle {
  font-size: 13px;
  line-height: 120%;
  color: Black;
  text-align: center;
}

h4.author { /* Header 4 - and the author and data headers use this too  */
  font-size: 17px;
  font-family: "Arial";
  color: Black;
  text-align: center;
}
h4.date { /* Header 4 - and the author and data headers use this too  */
  font-size: 17px;
  font-family: "Arial", Times, serif;
  color: Black;
  text-align: center;
}

h4.abstract { /* Header 4 - and the author and data headers use this too  */
  font-size: 10px;
  font-family: "Arial", Times, serif;
  color: black;
  text-align: center;
}

h4.institute{ /* Header 4 - and the author and data headers use this too  */
  font-size: 10px;
  font-family: "Arial", Times, serif;
  color: black;
  text-align: center;
}

body, td {
   font-size: 14px;
}
code.r{
  font-size: 13px;
}
pre {
  font-size: 13px
}
h1 { /* Header 1 */
  font-size: 16px;
  color: DarkBlue;
}
h2 { /* Header 2 */
    font-size: 16px;
  color: DarkBlue;
}
h3 { /* Header 3 */
  font-size: 15px;
  font-family: "Times New Roman", Times, serif;
  color: DarkBlue;

</style>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Longitudinal clustering analysis is ubiquitous in social and behavioral sciences for investigating the developmental processes of a phenomenon over time. Examples of the commonly used techniques in these areas include group-based trajectory modeling (GBTM) and the non-parametric kmeans method. Whilst kmeans has a number of benefits over GBTM, such as more relaxed statistical assumptions, generic implementations render it more sensitive to outliers and short-term fluctuations, which minimises its ability to identify long-term linear trends in data. In crime and place research, for example, the identification of such <code>long-term</code> linear trends may help to develop some theoretical understanding of criminal victimization within a geographical space <span class="citation">(Weisburd et al. 2004; Griffith and Chavez 2004)</span>. In order to address this sensitivity problem, we advance a novel technique named <code>anchored kmedoids</code> (<code>'akmedoids'</code>) which implements three key modifications to the existing longitudinal <code>kmeans</code> approach. First, it approximates trajectories using ordinary least square regression (<code>OLS</code>) and second, <code>anchors</code> the initialisation process with median observations. It then deploys the <code>medoids</code> observations as new anchors for each iteration of the expectation-maximization procedure <span class="citation">(Celeux and Govaert 1992)</span>. These modifications ensure that the impacts of short-term fluctuations and outliers are minimized. By linking the final groupings back to the original trajectories, a clearer delineation of the long-term linear trends of trajectories are obtained.</p>
<p>We facilitate the easy use of <code>akmedoids</code> through an open-source package using <code>R</code>. We encourage the use of the package outside of criminology, should it be appropriate. Before outlining the main <code>clustering</code> functions, we demonstrate the use of a few <code>data manipulation</code> functions that assist in data preparation. The worked demonstration uses a small example dataset which should allow users to get a clear understanding of the operation of each function.</p>
<table class="table table">
<caption>
Table 1. <code>Data manipulation</code> functions
</caption>
<thead><tr>
<th style="text-align:left;">
SN
</th>
<th style="text-align:left;">
Function
</th>
<th style="text-align:left;">
Title
</th>
<th style="text-align:left;">
Description
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
1
</td>
<td style="text-align:left;width: 8em; background-color: white !important;">
<code>data_imputation</code>
</td>
<td style="text-align:left;width: 12em; background-color: white !important;">
Data imputation for longitudinal data
</td>
<td style="text-align:left;width: 16em; background-color: white !important;">
Calculates any missing entries (<code>NA</code>, <code>Inf</code>, <code>null</code>) in a longitudinal data, according to a specified method
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
2
</td>
<td style="text-align:left;width: 8em; background-color: white !important;">
<code>rates</code>
</td>
<td style="text-align:left;width: 12em; background-color: white !important;">
Conversion of ‘counts’ to ‘rates’
</td>
<td style="text-align:left;width: 16em; background-color: white !important;">
Calculates rates from observed ‘counts’ and its associated denominator data
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
3
</td>
<td style="text-align:left;width: 8em; background-color: white !important;">
<code>props</code>
</td>
<td style="text-align:left;width: 12em; background-color: white !important;">
Conversion of ‘counts’ (or ‘rates’) to ‘Proportion’
</td>
<td style="text-align:left;width: 16em; background-color: white !important;">
Converts ‘counts’ or ‘rates’ observation to ‘proportion’
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
4
</td>
<td style="text-align:left;width: 8em; background-color: white !important;">
<code>outlier_detect</code>
</td>
<td style="text-align:left;width: 12em; background-color: white !important;">
Outlier detection and replacement
</td>
<td style="text-align:left;width: 16em; background-color: white !important;">
Identifies outlier observations in the data, and replace or remove them
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
5
</td>
<td style="text-align:left;width: 8em; background-color: white !important;">
<code>w_spaces</code>
</td>
<td style="text-align:left;width: 12em; background-color: white !important;">
Whitespace removal
</td>
<td style="text-align:left;width: 16em; background-color: white !important;">
Removes all the leading and trailing whitespaces in a longitudinal data
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
6
</td>
<td style="text-align:left;width: 8em; background-color: white !important;">
<code>remove_rows_n</code>
</td>
<td style="text-align:left;width: 12em; background-color: white !important;">
Incomplete rows removal
</td>
<td style="text-align:left;width: 16em; background-color: white !important;">
Removes rows which contain ‘NA’ and ‘inf’ entries
</td>
</tr>
</tbody>
</table>
</div>
<div id="data-manipulation" class="section level1">
<h1 class="hasAnchor">
<a href="#data-manipulation" class="anchor"></a>1. Data manipulation</h1>
<p>Table 1 shows the main data manipulation functions and their descriptions. These functions help to address common data issues prior to analysis, as well as basic data manipulation tasks such as converting longitudinal data from <code>count</code> to <code>proportion</code> measures (as per the crime inequality paper where <code>akmedoids</code> was first implemented). In order to demonstrate the utility of these functions, we provide a simulated dataset <code>traj</code> which can be called by typing <code>traj</code> in <code>R</code> console after loading the <code>akmedoids</code> library.</p>
<div id="i-data_imputation-function" class="section level2">
<h2 class="hasAnchor">
<a href="#i-data_imputation-function" class="anchor"></a>(i) <code>"data_imputation"</code> function</h2>
<p>Calculates any missing entries in a data, according to a chosen method. This function recognizes three kinds of data entries as missing. These are <code>NA</code>, <code>Inf</code>, <code>null</code>, and an option of whether or not to consider <code>0</code>’s as missing values. The function provides a replacement option for the missing entries using two methods. First, an <code>arithmetic</code> method which uses the <code>mean</code>, <code>minimum</code> or <code>maximum</code> value of the corresponding rows or columns of the missing values. Second, a <code>regression</code> method which uses OLS regression lines to estimate the missing values. Using the regression method, only the missing data points derive values from the regression line while the remaining (observed) data points retain their original values. The function terminates if there is any trajectory with only one observation in it. Using the <code>'traj'</code> dataset, we demonstrate how the <code>'regression'</code> method estimates missing values.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#installing the `akmedoids` packages</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"manalytics/akmedoids"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#loading the package</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cran.r-project.org/package=akmedoids">akmedoids</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#import and preview the first 6 rows of 'traj' object</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">traj</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">traj</span><span class="op">)</span>
<span class="co">#&gt;   location_ids X2001 X2002 X2003 X2004 X2005 X2006 X2007 X2008 X2009</span>
<span class="co">#&gt; 1    E01012628     3     0     1     2     1     0     1     4     0</span>
<span class="co">#&gt; 2    E01004768     9    NA     2     4     7     5     1     3     1</span>
<span class="co">#&gt; 3    E01004803     4     3     0    10     2     3     6     6     8</span>
<span class="co">#&gt; 4    E01004804     7     3     9     3     2    NA     6     3     2</span>
<span class="co">#&gt; 5    E01004807     2   Inf     5     5     6    NA     3     5     4</span>
<span class="co">#&gt; 6    E01004808     8     5     8     4     1     5     6     1     1</span>

<span class="co">#no. of rows</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">traj</span><span class="op">)</span> 
<span class="co">#&gt; [1] 10</span>

<span class="co">#no. of columns</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">traj</span><span class="op">)</span> 
<span class="co">#&gt; [1] 10</span></code></pre></div>
<p>The first column of the <code>traj</code> object is the <code>id</code> (unique) field. In many applications, it is necessary to preserve the <code>id</code> column in order to allow linking of outputs to other external datasets, such as spatial location data. Most of the functions of the <code>akmedoids</code> provides an option to recognise the first column of an input dataset as the unique field. The <code>data_imputation</code> function can be used to imput the missing data point of <code>traj</code> object as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">imp_traj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_imputation.html">data_imputation</a></span><span class="op">(</span><span class="va">traj</span>, id_field <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="fl">2</span>, 
               replace_with <span class="op">=</span> <span class="fl">1</span>, fill_zeros <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; [1] "8 entries were found/filled!"</span>

<span class="va">imp_traj</span> <span class="op">&lt;-</span> <span class="va">imp_traj</span><span class="op">$</span><span class="va">CompleteData</span>
<span class="co">#viewing the first 6 rows</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">imp_traj</span><span class="op">)</span>
<span class="co">#&gt;   location_ids X2001 X2002 X2003 X2004 X2005 X2006 X2007 X2008 X2009</span>
<span class="co">#&gt; 1    E01012628     3  0.00     1     2     1  0.00     1     4     0</span>
<span class="co">#&gt; 2    E01004768     9  6.44     2     4     7  5.00     1     3     1</span>
<span class="co">#&gt; 3    E01004803     4  3.00     0    10     2  3.00     6     6     8</span>
<span class="co">#&gt; 4    E01004804     7  3.00     9     3     2  3.90     6     3     2</span>
<span class="co">#&gt; 5    E01004807     2  3.92     5     5     6  4.36     3     5     4</span>
<span class="co">#&gt; 6    E01004808     8  5.00     8     4     1  5.00     6     1     1</span></code></pre></div>
<p>The argument <code>method = 2</code> refers to the <code>regression</code> technique, while the argument <code>replace_with = 1</code> refers to the <code>linear</code> option (currently the only available option). Figure 1 is a graphical illustration of how this method approximates the missing values of the <code>traj</code> object.</p>
<div id="estimating-the-population-data-using-the-data_imputation-function" class="section level3">
<h3 class="hasAnchor">
<a href="#estimating-the-population-data-using-the-data_imputation-function" class="anchor"></a>Estimating the population data using the <code>'data_imputation'</code> function</h3>
<p>Obtaining the denominator information (e.g. population estimates to normalize counts) of local areas within a city for non-census years is problematic in longitudinal studies. This challenge poses a significant drawback to the accurate estimation of various measures, such as crime rates and population-at-risk of an infectious disease. Assuming a limited amount of denominator information is available, an alternative way of obtaining the missing data points is to interpolate and/or extrapolate the missing population information using the available data points. The <code>data_imputation</code> function can be used to perform this task.</p>
<p>The key step towards using the function for this purpose is to create a matrix, containing both the available fields and the missing fields arranged in their appropriate order. All the entries of the missing fields can be filled with either <code>NA</code> or <code>null</code>. Below is a demonstration of this task with a sample population dataset with only two available data fields. The corresponding <code>input</code> matrix is constructed as shown.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#import population data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">popl</span><span class="op">)</span>

<span class="co">#preview the data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">popl</span><span class="op">)</span>
<span class="co">#&gt;   location_id census_2003 census_2007</span>
<span class="co">#&gt; 1   E01004809         300         200</span>
<span class="co">#&gt; 2   E01004807         550         450</span>
<span class="co">#&gt; 3   E01004788         150         250</span>
<span class="co">#&gt; 4   E01012628         100         100</span>
<span class="co">#&gt; 5   E01004805         400         350</span>
<span class="co">#&gt; 6   E01004790         750         850</span>

<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">popl</span><span class="op">)</span> <span class="co">#no. of rows</span>
<span class="co">#&gt; [1] 11</span>

<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">popl</span><span class="op">)</span> <span class="co">#no. of columns</span>
<span class="co">#&gt; [1] 3</span></code></pre></div>
<p>The corresponding <code>input</code> dataset is prepared as follows and saved as <code>population2</code>:</p>
<pre><code>#&gt;   location_ids X2001 X2002 X2003 X2004 X2005 X2006 X2007 X2008 X2009
#&gt; 1    E01004809    NA    NA   300    NA    NA    NA   200    NA    NA
#&gt; 2    E01004807    NA    NA   550    NA    NA    NA   450    NA    NA
#&gt; 3    E01004788    NA    NA   150    NA    NA    NA   250    NA    NA
#&gt; 4    E01012628    NA    NA   100    NA    NA    NA   100    NA    NA
#&gt; 5    E01004805    NA    NA   400    NA    NA    NA   350    NA    NA
#&gt; 6    E01004790    NA    NA   750    NA    NA    NA   850    NA    NA</code></pre>
<p>The missing values are estimated as follows using the <code>regression</code> method of the <code>data_imputation</code> function:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">pop_imp_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_imputation.html">data_imputation</a></span><span class="op">(</span><span class="va">population2</span>, id_field <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="fl">2</span>, 
               replace_with <span class="op">=</span> <span class="fl">1</span>, fill_zeros <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; [1] "77 entries were found/filled!"</span>

<span class="va">pop_imp_result</span> <span class="op">&lt;-</span> <span class="va">pop_imp_result</span><span class="op">$</span><span class="va">CompleteData</span>

<span class="co">#viewing the first 6 rows</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pop_imp_result</span><span class="op">)</span>
<span class="co">#&gt;   location_ids X2001 X2002 X2003 X2004 X2005 X2006 X2007 X2008 X2009</span>
<span class="co">#&gt; 1    E01004809   350   325   300   275   250   225   200   175   150</span>
<span class="co">#&gt; 2    E01004807   600   575   550   525   500   475   450   425   400</span>
<span class="co">#&gt; 3    E01004788   100   125   150   175   200   225   250   275   300</span>
<span class="co">#&gt; 4    E01012628   100   100   100   100   100   100   100   100   100</span>
<span class="co">#&gt; 5    E01004805   425 412.5   400 387.5   375 362.5   350 337.5   325</span>
<span class="co">#&gt; 6    E01004790   700   725   750   775   800   825   850   875   900</span></code></pre></div>
<p>Given that there are only two data points in each row, the <code>regression</code> method will simply generate the missing values by fitting a straight line to the available data points. The higher the number of available data points in any trajectory the better the estimation of the missing points. Figure 1 illustrates this estimation process.</p>
</div>
</div>
<div id="ii-rates-function" class="section level2">
<h2 class="hasAnchor">
<a href="#ii-rates-function" class="anchor"></a>(ii) <code>"rates"</code> function</h2>
<p>Given a longitudinal data (<span class="math inline">\(m\times n\)</span>) and its associated denominator data (<span class="math inline">\(s\times n\)</span>), the <code>'rates'</code> function converts the longitudinal data to ‘rates’ measures (e.g. counts per 100 residents). Both the longitudinal and the denominator data may contain different number of rows, but need to have the same number of columns, and must include the <code>id</code> (unique) field as their first column. The rows do not have to be sorted in any particular order. The rate measures (i.e. the output) will contain only rows whose <code>id's</code> match from both datasets. We demonstrate the utility of this function using the <code>imp_traj</code> object (above) and the estimated population data (‘<code>pop_imp_result</code>’).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#example of estimation of 'crimes per 200 residents'</span>
<span class="va">crime_per_200_people</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rates.html">rates</a></span><span class="op">(</span><span class="va">imp_traj</span>, denomin<span class="op">=</span><span class="va">pop_imp_result</span>, id_field<span class="op">=</span><span class="cn">TRUE</span>, 
                              multiplier <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>

<span class="co">#view the full output</span>
<span class="va">crime_per_200_people</span> <span class="op">&lt;-</span> <span class="va">crime_per_200_people</span><span class="op">$</span><span class="va">rates_estimates</span>

<span class="co">#check the number of rows</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">crime_per_200_people</span><span class="op">)</span>
<span class="co">#&gt; [1] 9</span></code></pre></div>
<p>From the output, it can be observed that the number of rows of the output data is 9. This implies that only 9 <code>location_ids</code> match between the two datasets. The unmatched <code>ids</code> are ignored. <strong>Note</strong>: the calculation of <code>rates</code> often returns outputs with some of the cell entries having <code>Inf</code> and <code>NA</code> values, due to calculation errors and character values in the data. We therefore recommend that users re-run the <code>data_imputation</code> function after generating <code>rates</code> measures, especially for a large data matrix.</p>
</div>
<div id="iii-props-function" class="section level2">
<h2 class="hasAnchor">
<a href="#iii-props-function" class="anchor"></a>(iii) <code>"props"</code> function</h2>
<p>Given a longitudinal data, the <code>props</code> function converts each data point (i.e. entry in each cell) to the proportion of the sum of their corresponding column. Using the <code>crime_per_200_people</code> estimated above, we can derive the <code>proportion of crime per 200 people</code> for each entry as follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#Proportions of crimes per 200 residents</span>
<span class="va">prop_crime_per200_people</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/props.html">props</a></span><span class="op">(</span><span class="va">crime_per_200_people</span>, id_field <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="fl">1</span>, digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span>

<span class="co">#view the full output</span>
<span class="va">prop_crime_per200_people</span>
<span class="co">#&gt;   location_ids X2001 X2002 X2003 X2004 X2005 X2006 X2007 X2008 X2009</span>
<span class="co">#&gt; 1    E01012628  0.10  0.13  0.04  0.09  0.21  0.19  0.05  0.14  0.17</span>
<span class="co">#&gt; 2    E01004768  0.12  0.28  0.13  0.09  0.09  0.17  0.04  0.08  0.00</span>
<span class="co">#&gt; 3    E01004803  0.08  0.11  0.16  0.13  0.17  0.16  0.17  0.15  0.17</span>
<span class="co">#&gt; 4    E01004804  0.07  0.07  0.00  0.18  0.04  0.06  0.12  0.08  0.24</span>
<span class="co">#&gt; 5    E01004807  0.15  0.08  0.18  0.06  0.04  0.08  0.12  0.04  0.06</span>
<span class="co">#&gt; 6    E01004808  0.11  0.11  0.18  0.14  0.22  0.11  0.16  0.13  0.16</span>
<span class="co">#&gt; 7    E01004788  0.02  0.06  0.06  0.07  0.11  0.09  0.07  0.08  0.17</span>
<span class="co">#&gt; 8    E01004790  0.18  0.16  0.19  0.09  0.03  0.13  0.16  0.02  0.04</span>
<span class="co">#&gt; 9    E01004805  0.17  0.00  0.07  0.15  0.09  0.00  0.10  0.28  0.00</span>


<span class="co">#A quick check that sum of each column of proportion measures adds up to 1.  </span>
<span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">prop_crime_per200_people</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">prop_crime_per200_people</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; X2001 X2002 X2003 X2004 X2005 X2006 X2007 X2008 X2009 </span>
<span class="co">#&gt;  1.00  1.00  1.01  1.00  1.00  0.99  0.99  1.00  1.01</span></code></pre></div>
<p>In line with the demonstration in Adepeju et al. (2021), we will use these <code>proportion</code> measures to demonstrate the main clustering function of this package.</p>
</div>
<div id="iv-outlier_detect-function" class="section level2">
<h2 class="hasAnchor">
<a href="#iv-outlier_detect-function" class="anchor"></a>(iv) <code>"outlier_detect"</code> function</h2>
<p>This function is aimed at allowing users to identify any outlier observations in their longitudinal data, and replace or remove them accordingly. The first step towards identifying outliers in any data is to visualize the data. A user can then decide a cut-off value for isolating the outliers. The <code>outlier_detect</code> function provides two options for doing this: (<code>i</code>) a <code>quantile</code> method, which isolates any observations with values higher than a specified quantile of the data values distribution, and (<code>ii</code>) a <code>manual</code> method, in which a user specifies the cut-off value. The ‘<code>replace_with</code>’ argument is used to determine whether an outlier value should be replaced with the mean value of the row or the mean value of the column in which the outlier is located. The user also has the option to simply remove the trajectory that contains an outlier value. In deciding whether a trajectory contains outlier or not, the <code>count</code> argument allows the user to set an horizontal threshold (i.e. number of outlier values that must occur in a trajectory) in order for the trajectory to be considered as having outlier observations. Below, we demonstrate the utility of the <code>outlier_detect</code> function using the <code>imp_traj</code> data above.</p>
</div>
<div id="v-w_spaces-function" class="section level2">
<h2 class="hasAnchor">
<a href="#v-w_spaces-function" class="anchor"></a>(v) <code>"w_spaces"</code> function</h2>
<p>Given a matrix suspected to contain whitespaces, this function removes all the whitespaces and returns a cleaned data. ’Whitespaces’ are white characters often introduced during data entry, for instance by wrongly pressing the spacebar. For example, neither " A" nor “A” equates “A” because of the whitespaces that exist in them. They can also result from systematic errors in data recording devices.</p>
</div>
<div id="vi-remove_rows_n-function" class="section level2">
<h2 class="hasAnchor">
<a href="#vi-remove_rows_n-function" class="anchor"></a>(vi) <code>"remove_rows_n"</code> function</h2>
<p>This function removes any rows in which an ‘NA’ or an ‘Inf’ entry is found.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#Plotting the data using ggplot library</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="co">#&gt; Warning: package 'ggplot2' was built under R version 4.0.5</span>
<span class="co">#library(reshape2)</span>

<span class="co">#converting the wide data format into stacked format for plotting</span>
<span class="co">#doing it manually instead of using 'melt' function from 'reshape2'</span>

<span class="co">#imp_traj_long &lt;- melt(imp_traj, id="location_ids") </span>

<span class="va">coln</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">imp_traj</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">imp_traj</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
<span class="va">code_</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">imp_traj</span><span class="op">$</span><span class="va">location_ids</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">imp_traj</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="va">d_bind</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">v</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">imp_traj</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="va">d_bind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">d_bind</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">imp_traj</span><span class="op">[</span>,<span class="op">(</span><span class="va">v</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>

<span class="va">code</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>location_ids<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">code_</span><span class="op">)</span><span class="op">)</span>
<span class="va">variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>variable<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">coln</span>,
                        each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">imp_traj</span><span class="op">$</span><span class="va">location_ids</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">value</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">d_bind</span><span class="op">)</span><span class="op">)</span>

<span class="va">imp_traj_long</span> <span class="op">&lt;-</span> <span class="fu">bind_cols</span><span class="op">(</span><span class="va">code</span>, <span class="va">variable</span>,<span class="va">value</span><span class="op">)</span> 
  
<span class="co">#view the first 6 rows</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">imp_traj_long</span><span class="op">)</span>
<span class="co">#&gt;   location_ids variable value</span>
<span class="co">#&gt; 1    E01012628    X2001     3</span>
<span class="co">#&gt; 2    E01004768    X2001     9</span>
<span class="co">#&gt; 3    E01004803    X2001     4</span>
<span class="co">#&gt; 4    E01004804    X2001     7</span>
<span class="co">#&gt; 5    E01004807    X2001     2</span>
<span class="co">#&gt; 6    E01004808    X2001     8</span>

<span class="co">#plot function</span>
<span class="va">p</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">imp_traj_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">variable</span>, y<span class="op">=</span><span class="va">value</span>,
            group<span class="op">=</span><span class="va">location_ids</span>, color<span class="op">=</span><span class="va">location_ids</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span>

<span class="co">#options(rgl.useNULL = TRUE)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="akmedoids-vignette_files/figure-html/figs2-1.png" alt="Figure 2: Identifying outliers" width="576"><p class="caption">
Figure 2: Identifying outliers
</p>
</div>
<p>Figure 2 is the output of the above plot function.</p>
<p>Based on Figure 2 if we assume that observations of <code>x2001</code>, <code>x2007</code> and <code>x2008</code> of trajectory id <code>E01004806</code> are outliers, we can set the <code>threshold</code> argument as <code>20</code>. In this case, setting <code>count=1</code> will suffice as the trajectory is clearly separable from the rest of the trajectories.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">imp_traj_New</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/outlier_detect.html">outlier_detect</a></span><span class="op">(</span><span class="va">imp_traj</span>, id_field <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="fl">2</span>, 
                              threshold <span class="op">=</span> <span class="fl">20</span>, count <span class="op">=</span> <span class="fl">1</span>, replace_with <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; [1] "1 trajectories were found to contain outlier observations and replaced accordingly!"</span>
<span class="co">#&gt; [1] "Summary:"</span>
<span class="co">#&gt; [1] "*--Outlier observation(s) was found in trajectory 10 --*"</span>

<span class="va">imp_traj_New</span> <span class="op">&lt;-</span> <span class="va">imp_traj_New</span><span class="op">$</span><span class="va">Outliers_Replaced</span> 

<span class="co">#options(rgl.useNULL = TRUE)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">imp_traj_New</span><span class="op">)</span>
<span class="co">#&gt;    location_ids X2001 X2002 X2003 X2004 X2005 X2006 X2007 X2008 X2009</span>
<span class="co">#&gt; 1     E01012628  3.00  0.00  1.00     2     1  0.00  1.00  4.00     0</span>
<span class="co">#&gt; 2     E01004768  9.00  6.44  2.00     4     7  5.00  1.00  3.00     1</span>
<span class="co">#&gt; 3     E01004803  4.00  3.00  0.00    10     2  3.00  6.00  6.00     8</span>
<span class="co">#&gt; 4     E01004804  7.00  3.00  9.00     3     2  3.90  6.00  3.00     2</span>
<span class="co">#&gt; 5     E01004807  2.00  3.92  5.00     5     6  4.36  3.00  5.00     4</span>
<span class="co">#&gt; 6     E01004808  8.00  5.00  8.00     4     1  5.00  6.00  1.00     1</span>
<span class="co">#&gt; 7     E01004788  2.00  4.00  2.72     2     2  4.00  1.00  3.00     0</span>
<span class="co">#&gt; 8     E01004790 10.00  9.00 17.00    13    15 13.63 13.98 19.00     9</span>
<span class="co">#&gt; 9     E01004805  8.00  5.00 10.00     7     9  4.00  5.41  6.00     3</span>
<span class="co">#&gt; 10    E01004806 14.83 12.00 14.00    15    18 13.00 14.83 14.83    17</span>

<span class="co">#imp_traj_New_long &lt;- melt(imp_traj_New, id="location_ids") </span>

<span class="va">coln</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">imp_traj_New</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">imp_traj_New</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
<span class="va">code_</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">imp_traj_New</span><span class="op">$</span><span class="va">location_ids</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">imp_traj_New</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>

<span class="va">d_bind</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">v</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">imp_traj_New</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="va">d_bind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">d_bind</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">imp_traj_New</span><span class="op">[</span>,<span class="op">(</span><span class="va">v</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>

<span class="va">code</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>location_ids<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">code_</span><span class="op">)</span><span class="op">)</span>
<span class="va">variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>variable<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">coln</span>,
              each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">imp_traj_New</span><span class="op">$</span><span class="va">location_ids</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">value</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">d_bind</span><span class="op">)</span><span class="op">)</span>

<span class="va">imp_traj_New_long</span> <span class="op">&lt;-</span> <span class="fu">bind_cols</span><span class="op">(</span><span class="va">code</span>, <span class="va">variable</span>,<span class="va">value</span><span class="op">)</span>

<span class="co">#plot function</span>
<span class="co">#options(rgl.useNULL = TRUE)</span>
<span class="va">p</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">imp_traj_New_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">variable</span>, y<span class="op">=</span><span class="va">value</span>,
            group<span class="op">=</span><span class="va">location_ids</span>, color<span class="op">=</span><span class="va">location_ids</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span>

<span class="co">#options(rgl.useNULL = TRUE)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="akmedoids-vignette_files/figure-html/figs3-1.png" alt="Figure 3: Replacing outliers with mean observation" width="576"><p class="caption">
Figure 3: Replacing outliers with mean observation
</p>
</div>
<p>Setting <code>replace_with = 2</code>, that is to replace the outlier points with the ‘mean of the row observations’, the function generates outputs re-plotted in Figure 3.</p>
</div>
<div id="vii-other-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#vii-other-functions" class="anchor"></a>(vii) ‘Other’ functions</h2>
<p>Please see the <code>akmedoids</code> user manual for the remaining <code>data manipulation</code> functions.</p>
</div>
</div>
<div id="data-clustering" class="section level1">
<h1 class="hasAnchor">
<a href="#data-clustering" class="anchor"></a>2. Data Clustering</h1>
<p>Table 2 shows the two main functions required to carry out the longitudinal clustering and generate the descriptive statistics of the resulting groups. The relevant functions are <code>akclustr</code> and <code>print_akstats</code>. The <code>akclustr</code> function clusters trajectories according to the similarities of their long-term trends, while the <code>print_akstats</code> function extracts descriptive and change statistics for each of the clusters. The former also generates <code>quality</code> plots for the best cluster solution.</p>
<p>The long-term trends of trajectories are defined in terms of a set of OLS regression lines. This allows the clustering function to classify the final groupings in terms of their slopes as <code>rising</code>, <code>stable</code>, and <code>falling</code>. The key benefits of this implementation is that it allows the clustering process to ignore the short-term fluctuations of actual trajectories and focus on their long-term linear trends. Adepeju and colleagues (2021) applied this technique in crime concentration research for measuring long-term inequalities in the exposure to crime at find-grained spatial scales.</p>
<div class="figure" style="text-align: center">
<img src="inequality.png" alt="Figure 4: Long-time linear trends of relative (`proportion`, `p`) crime exposure. Three inequality trends: trajectory i1: crime exposure is falling faster, i2, crime exposure is falling at the same rate, and i3, crime exposure is falling slower or increasing, relatively to the citywide trend. (Source: Adepeju et al. 2021)" width="60%"><p class="caption">
Figure 4: Long-time linear trends of relative (<code>proportion</code>, <code>p</code>) crime exposure. Three inequality trends: trajectory i1: crime exposure is falling faster, i2, crime exposure is falling at the same rate, and i3, crime exposure is falling slower or increasing, relatively to the citywide trend. (Source: Adepeju et al. 2021)
</p>
</div>
<p>Their implementation was informed by the conceptual (<code>inequality</code>) framework shown in Figure 4. That said, <code>akmedoids</code> can be deployed on any measure (counts, rates) and is not limited to criminology, but rather, any field where the aim is to cluster longitudinal data based on long-term trajectories. By mapping the resulting trend lines grouping to the original trajectories, various performance statistics can be generated.</p>
<p>In addition to the use of trend lines, the <code>akmedoids</code> makes two other modifications to the expectation-maximisation clustering routines <span class="citation">(Celeux and Govaert 1992)</span>. First, the <code>akmedoids</code> implements an anchored median-based initialisation strategy for the clustering to begin. The purpose behind this step is to give the algorithm a theoretically-driven starting point and try and ensure that heterogenous trend slopes end up in different clusters (<span class="citation">Khan and Ahmad (2004)</span>; <span class="citation">Steinley and Brusco (2007)</span>). Second, instead of recomputing centroids based on the mean distances between each trajectory trend lines and the cluster centers, the median of each cluster is selected and then used as the next centroid. This then becomes the new anchor for the current iteration of the expectation-maximisation step <span class="citation">(Celeux and Govaert 1992)</span>. This strategy is implemented in order to minimize the impact of outliers. The iteration then continues until an objective function is maximised.</p>
<table class="table table">
<caption>
Table 2. <code>Data clustering</code> functions
</caption>
<thead><tr>
<th style="text-align:left;">
SN
</th>
<th style="text-align:left;">
Function
</th>
<th style="text-align:left;">
Title
</th>
<th style="text-align:left;">
Description
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
1
</td>
<td style="text-align:left;width: 8em; background-color: white !important;">
<code>akclustr</code>
</td>
<td style="text-align:left;width: 12em; background-color: white !important;">
<code>Anchored k-medoids clustering</code>
</td>
<td style="text-align:left;width: 16em; background-color: white !important;">
Clusters trajectories into a <code>k</code> number of groups according to the similarities in their long-term trend and determines the best solution based on the Silhouette width measure or the Calinski-Harabasz criterion
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
2
</td>
<td style="text-align:left;width: 8em; background-color: white !important;">
<code>print_akstats</code>
</td>
<td style="text-align:left;width: 12em; background-color: white !important;">
<code>Descriptive (Change) statistics of clusters</code>
</td>
<td style="text-align:left;width: 16em; background-color: white !important;">
Generates the descriptive and change statistics of groups, and also plots the groups performances
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
3
</td>
<td style="text-align:left;width: 8em; background-color: white !important;">
<code>plot_akstats</code>
</td>
<td style="text-align:left;width: 12em; background-color: white !important;">
<code>Plots of cluster groups</code>
</td>
<td style="text-align:left;width: 16em; background-color: white !important;">
Generates different plots of cluster groups
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#Visualizing the proportion data</span>

<span class="co">#view the first few rows</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">prop_crime_per200_people</span><span class="op">)</span>
<span class="co">#&gt;   location_ids X2001 X2002 X2003 X2004 X2005 X2006 X2007 X2008 X2009</span>
<span class="co">#&gt; 1    E01012628  0.10  0.13  0.04  0.09  0.21  0.19  0.05  0.14  0.17</span>
<span class="co">#&gt; 2    E01004768  0.12  0.28  0.13  0.09  0.09  0.17  0.04  0.08  0.00</span>
<span class="co">#&gt; 3    E01004803  0.08  0.11  0.16  0.13  0.17  0.16  0.17  0.15  0.17</span>
<span class="co">#&gt; 4    E01004804  0.07  0.07  0.00  0.18  0.04  0.06  0.12  0.08  0.24</span>
<span class="co">#&gt; 5    E01004807  0.15  0.08  0.18  0.06  0.04  0.08  0.12  0.04  0.06</span>
<span class="co">#&gt; 6    E01004808  0.11  0.11  0.18  0.14  0.22  0.11  0.16  0.13  0.16</span>

<span class="co">#prop_crime_per200_people_melt &lt;- melt(prop_crime_per200_people, id="location_ids") </span>
<span class="va">coln</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">prop_crime_per200_people</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">prop_crime_per200_people</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
<span class="va">code_</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">prop_crime_per200_people</span><span class="op">$</span><span class="va">location_ids</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">prop_crime_per200_people</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="va">d_bind</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">v</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">prop_crime_per200_people</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="va">d_bind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">d_bind</span>, <span class="va">prop_crime_per200_people</span><span class="op">[</span>,<span class="op">(</span><span class="va">v</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
  <span class="op">}</span>

<span class="va">prop_crime_per200_people_melt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>location_ids<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">code_</span><span class="op">)</span>, variable <span class="op">=</span>
                        <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">coln</span>,
                        each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">prop_crime_per200_people</span><span class="op">$</span><span class="va">location_ids</span><span class="op">)</span><span class="op">)</span>, value<span class="op">=</span><span class="va">d_bind</span><span class="op">)</span><span class="op">)</span>

<span class="co">#plot function</span>
<span class="co">#options(rgl.useNULL = TRUE)</span>
<span class="va">p</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">prop_crime_per200_people_melt</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">variable</span>, y<span class="op">=</span><span class="va">value</span>,
            group<span class="op">=</span><span class="va">location_ids</span>, color<span class="op">=</span><span class="va">location_ids</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span>

<span class="co">#options(rgl.useNULL = TRUE)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="akmedoids-vignette_files/figure-html/figs5-1.png" alt="Figure 5: Trajectory of crime proportions over time" width="576"><p class="caption">
Figure 5: Trajectory of crime proportions over time
</p>
</div>
<p>In the following sections, we provide a worked example of clustering with <code>akclustr</code> function using the <code>prop_crime_per200_people</code> object. The function will generate cluster solution over a set of <code>k</code> values, determine the optimal value of <code>k</code>. The <code>print_akstats</code> function will then be applied to generate the descriptive summary and the change statistics of the clusters. The <code>prop_crime_per200_people</code> object is plotted in 5.</p>
<div id="i-akclustr-function" class="section level2">
<h2 class="hasAnchor">
<a href="#i-akclustr-function" class="anchor"></a>(i) <code>akclustr</code> function</h2>
<p><strong><em>Dataset</em></strong>:</p>
<p>Each trajectory in Figure 5 represents the proportion of crimes per 200 residents in each location over time. The goal is to first extract the inequality trend lines such as in Figure 4 and then cluster them according to the similarity of their slopes. For the <code>akclustr</code> function, a user sets the <code>k</code> value which may be an integer or a vector of length two specifying the minimum and maximum numbers of clusters to loop through. In the latter case, the <code>akclustr</code> function employs either the <code>Silhouette</code> (<span class="citation">Rousseeuw (1987)</span>)) or the <code>Calinski_Harabasz</code> score (<span class="citation">Caliński and Harabasz (1974)</span>; <span class="citation">Genolini and Falissard (2010)</span>) to determine the best cluster solution. In other words, it determines the <code>k</code> value that optimizes the specified criterion. The <code>verbose</code> argument can be used to control the processing messages. The function is executed as follows:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#clustering</span>
<span class="va">akObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/akclustr.html">akclustr</a></span><span class="op">(</span><span class="va">prop_crime_per200_people</span>, id_field <span class="op">=</span> <span class="cn">TRUE</span>, 
                                method <span class="op">=</span> <span class="st">"linear"</span>, k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">8</span><span class="op">)</span>, crit <span class="op">=</span> <span class="st">"Calinski_Harabasz"</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; [1] "Processing...."</span>
<span class="co">#&gt; [1] ".............."</span>
<span class="co">#&gt; [1] "solution of k = 3 determined!"</span>
<span class="co">#&gt; [1] "solution of k = 4 determined!"</span>
<span class="co">#&gt; [1] "solution of k = 5 determined!"</span>
<span class="co">#&gt; [1] "solution of k = 6 determined!"</span>
<span class="co">#&gt; [1] "solution of k = 7 determined!"</span>
<span class="co">#&gt; [1] "solution of k = 8 determined!"</span></code></pre></div>
<p>In order to preview all the variables of the <code>quality_plot</code> object, type:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">akObj</span><span class="op">)</span>
<span class="co">#&gt; [1] "traj"             "id_field"         "solutions"        "qualitycriterion"</span>
<span class="co">#&gt; [5] "optimal_k"        "qualityCrit.List" "qltyplot"</span></code></pre></div>
<ul>
<li>
<p>The description of these variables are as follow:</p>
<ul>
<li><p><code>traj</code> - returns the input data set used for the clustering.</p></li>
<li><p><code>id_field</code> - indicates whether the input data set included the id field.</p></li>
<li><p><code>solutions</code> - the list of cluster solutions by <code>k</code> values.</p></li>
<li><p><code>qualitycriterion</code> - the quality criterion specified.</p></li>
<li><p><code>optimal_k</code> - the optimal value of <code>k</code> as determined by the quality criterion.</p></li>
<li><p><code>qualityCrit.List</code> - the estimated quality of cluster solutions by <code>k</code> values.</p></li>
<li><p><code>qltyplot</code> - the plot of <code>qualityCrit.List</code>, with a red vertical line to indicate the optimal value of <code>k</code>.</p></li>
</ul>
</li>
</ul>
<p><strong><em>Accessing the optimal solution</em></strong>*</p>
<p>The <code>qualityCrit.List</code> can be viewed graphically by setting the <code>quality_plot</code> argument as <code>TRUE</code>. Also, the plot may still be accessed after clustering by printing the variable <code>akObj$qltyplot</code>.</p>
<div class="figure" style="text-align: center">
<img src="caliHara.png" alt="Figure 6: Clustering performance at different values of k" width="80%"><p class="caption">
Figure 6: Clustering performance at different values of k
</p>
</div>
<p>From (Figure 6), the best value of <code>k</code> is the highest at <code>k=5</code>, and therefore determined as the best solution. It is recommended that the determination based on either of the quality criteria should be used complementarily with users judgment in relation to the problem at hand.</p>
<p>Given a value of <code>k</code>, the group membership (labels) of its cluster solution can be extracted by entering <code>k'= k - 2</code>) into the variable <code>akObj$solutions[[k']]</code>. E.g.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#5-group clusters</span>
<span class="va">akObj</span><span class="op">$</span><span class="va">solutions</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="co">#for `k=5` solution</span>
<span class="co">#&gt; [1] "D" "A" "D" "E" "B" "C" "E" "A" "C"</span>
<span class="co">#&gt; attr(,"cluster labels for k =")</span>
<span class="co">#&gt; [1] 5</span></code></pre></div>
<p>Also, note that the indexes of the group memberships correspond to that of the trajectory object (<code>prop_crime_per200_people</code>) inputted into the function. That is, the membership labels, <code>"D"</code>, <code>"A"</code>, <code>"A"</code>, <code>....</code> are the group membership of the trajectories <code>"E01012628"</code>,<code>"E01004768"</code>,<code>"E01004803"</code>,<code>...</code> of the object <code>prop_crime_per200_people</code>.</p>
</div>
<div id="ii-print_akstats-function" class="section level2">
<h2 class="hasAnchor">
<a href="#ii-print_akstats-function" class="anchor"></a>(ii) <code>print_akstats</code> function:</h2>
<p>The properties (i.e. the descriptive and change statistics) of a cluster solutions (i.e. solution for any value of <code>k</code>) such as in <code>k = 5</code> above can be generated by using the special <code>print</code> function <code>print_akstats</code>. The print function takes as input the <code>akobject</code> class, e.g. <code>akObj</code>. The descriptive statistics shows the <code>group memberships</code> and their <code>performances</code> in terms of their shares of the <code>proportion</code> measure captured over time. The change statistics shows the information regarding the direction variances of the groups in relation to reference direction. In trajectory clustering analysis, the resulting groups are often re-classified into larger classes based on the slopes, such as <code>Decreasing</code>, <code>Stable</code>, or <code>Increasing</code> classes (<span class="citation">Weisburd et al. (2004)</span>; Andresen et al. 2017). The slope of a group is the angle made by the medoid of the group relative to a reference line (<span class="math inline">\(R\)</span>). The <code>reference</code> argument is specified as <code>1</code>, <code>2</code> or <code>3</code>, representing the <code>mean trajectory</code>, <code>medoid trajectory</code>, or a <code>horizontal line with slope = 0</code>, respectively. Let <span class="math inline">\(\vartheta_{1}\)</span> and <span class="math inline">\(\vartheta_{n}\)</span> represent the angular deviations of the group medoids with the lowest slope (negative) and highest (positive) slopes, respectively.</p>
<div class="figure" style="text-align: center">
<img src="Nquant.png" alt="Figure 7: Quantile sub-divisions of most-diverging groups (n_quant=4)" width="80%"><p class="caption">
Figure 7: Quantile sub-divisions of most-diverging groups (n_quant=4)
</p>
</div>
<p>If we sub-divide each of these slopes into a specified number of equal intervals (quantiles), the specific interval within which each group medoid falls can be determined. This specification is made using the <code>n_quant</code> argument. Figure 7 illustrates the quantiles sub-divisions for <code>n_quant = 4</code>.</p>
<p>In addition to the slope composition of trajectories found in each group, the quantile location of each group medoid can be used to further categorize the groups into larger classes. We refer users to the package <code>user manual</code> for more details about these parameters. Using the current example, the function can be ran as follows:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#Specifying the optimal solution, output$optimal_k (i.e. `k = 5`) and using `stacked` type graph</span>
<span class="va">prpties</span> <span class="op">=</span> <span class="fu"><a href="../reference/print_akstats.html">print_akstats</a></span><span class="op">(</span><span class="va">akObj</span>, k <span class="op">=</span> <span class="fl">5</span>, show_plots <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Warning: `fun.y` is deprecated. Use `fun` instead.</span>

<span class="va">prpties</span>
<span class="co">#&gt; $descriptive_stats</span>
<span class="co">#&gt;   group n n(%) %Prop.time1 %Prop.timeT Change %Change</span>
<span class="co">#&gt; 1     A 2 22.2          30           4    -26    -650</span>
<span class="co">#&gt; 2     B 1 11.1          15         5.9   -9.1  -154.2</span>
<span class="co">#&gt; 3     C 2 22.2          28        15.8  -12.2   -77.2</span>
<span class="co">#&gt; 4     D 2 22.2          18        33.7   15.7    46.6</span>
<span class="co">#&gt; 5     E 2 22.2           9        40.6   31.6    77.8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $change_stats</span>
<span class="co">#&gt;   group sn %+ve Traj. %-ve Traj. Qtl:1st-4th</span>
<span class="co">#&gt; 1     A  1          0        100   4th (-ve)</span>
<span class="co">#&gt; 2     B  2          0        100   3rd (-ve)</span>
<span class="co">#&gt; 3     C  3        100          0   1st (+ve)</span>
<span class="co">#&gt; 4     D  4        100          0   3rd (+ve)</span>
<span class="co">#&gt; 5     E  5        100          0   4th (+ve)</span></code></pre></div>
</div>
<div id="iii-plot_akstats-function" class="section level2">
<h2 class="hasAnchor">
<a href="#iii-plot_akstats-function" class="anchor"></a>(iii) <code>plot_akstats</code> function:</h2>
<p>The above printouts represent the properties (i.e. the descriptive and change properties) of the clusters. Note: the <code>show_plots</code> argument of <code>print_akstats</code> function, if set as <code>TRUE</code>, will produce the plot of group trajectories, representing the group directional change over time. However, the <code>plot_akstats</code> has been designed to generate different performance plots of the groups. See below:</p>
<ol style="list-style-type: lower-alpha">
<li><strong><em>Group trajectories (directional change over time)</em></strong></li>
</ol>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R">
  <span class="co">#options(rgl.useNULL = TRUE)</span>
  <span class="fu"><a href="../reference/plot_akstats.html">plot_akstats</a></span><span class="op">(</span><span class="va">akObj</span>, k <span class="op">=</span> <span class="fl">5</span>, type<span class="op">=</span><span class="st">"lines"</span>, y_scaling<span class="op">=</span><span class="st">"fixed"</span><span class="op">)</span>
<span class="co">#&gt; Warning: `fun.y` is deprecated. Use `fun` instead.</span>
<span class="co">#&gt; $cluster_plot</span></code></pre></div>
<p><img src="akmedoids-vignette_files/figure-html/unnamed-chunk-17-1.png" width="480" style="display: block; margin: auto;"></p>
<ol start="2" style="list-style-type: lower-alpha">
<li><strong><em>Proportional change of groups change over time</em></strong></li>
</ol>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="co">#options(rgl.useNULL = TRUE)</span>
  <span class="fu"><a href="../reference/plot_akstats.html">plot_akstats</a></span><span class="op">(</span><span class="va">akObj</span>, k <span class="op">=</span> <span class="fl">5</span>, reference <span class="op">=</span> <span class="fl">1</span>, n_quant <span class="op">=</span> <span class="fl">4</span>, type<span class="op">=</span><span class="st">"stacked"</span><span class="op">)</span>
<span class="co">#&gt; $cluster_plot</span></code></pre></div>
<p><img src="akmedoids-vignette_files/figure-html/unnamed-chunk-18-1.png" width="480" style="display: block; margin: auto;"></p>
<p>In the context of the long-term inequality study, broad conclusions can be made from both the statistical properties and the plots regarding relative crime exposure in the area represented by each group or class (Adepeju et al. 2021). For example, whilst relative crime exposure have declined in 33.3% (groups <code>A</code> and <code>B</code>) of the study area, the relative crime exposure have risen in 44.4% (groups <code>D</code> and <code>E</code>) of the area. The relative crime exposure can be said to be <code>stable</code> in 22.2% (group <code>C</code>) of the area, based on its close proximity to the reference line. The medoid of the group falls within the <span class="math inline">\(1^{st}(+ve)\)</span> quantile (see Figure ). In essence, we determine that groups <code>A</code> and <code>B</code> belong to the <code>Decreasing</code> class, while groups <code>D</code> and <code>E</code> belong to the <code>Increasing</code> class.</p>
<p>It is important to state that this proposed classification method is simply advisory; you may devise a different approach or interpretation depending on your research questions and data.</p>
<p>By changing the argument <code>type="lines"</code> to <code>type="stacked"</code>, a <code>quality plot</code> is generated instead (see Figure ). Note that these plots make use of functions within the <code>ggplot2</code> library <span class="citation">(Wickham 2016)</span>. For a more customized visualization, we recommend that users deploy the <code>ggplot2</code> library directly.</p>
<table class="table table">
<caption>
Table 3. field description of clustering outputs
</caption>
<thead><tr>
<th style="text-align:left;">
SN
</th>
<th style="text-align:left;">
field
</th>
<th style="text-align:left;">
Description
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
1
</td>
<td style="text-align:left;width: 8em; background-color: white !important;">
<code>group</code>
</td>
<td style="text-align:left;width: 12em; background-color: white !important;">
<code>group membershp</code>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
2
</td>
<td style="text-align:left;width: 8em; background-color: white !important;">
<code>n</code>
</td>
<td style="text-align:left;width: 12em; background-color: white !important;">
<code><a href="https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html">size (no.of.trajectories.)</a></code>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
3
</td>
<td style="text-align:left;width: 8em; background-color: white !important;">
<code>n(%)</code>
</td>
<td style="text-align:left;width: 12em; background-color: white !important;">
<code>% size</code>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
4
</td>
<td style="text-align:left;width: 8em; background-color: white !important;">
<code>%Prop.time1</code>
</td>
<td style="text-align:left;width: 12em; background-color: white !important;">
<code>% proportion of obs. at time 1 (2001)</code>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
5
</td>
<td style="text-align:left;width: 8em; background-color: white !important;">
<code>%Prop.timeT</code>
</td>
<td style="text-align:left;width: 12em; background-color: white !important;">
<code>proportion of obs. at time T (2009)</code>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
6
</td>
<td style="text-align:left;width: 8em; background-color: white !important;">
<code>Change</code>
</td>
<td style="text-align:left;width: 12em; background-color: white !important;">
<code>absolute change in proportion between time1 and timeT</code>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
7
</td>
<td style="text-align:left;width: 8em; background-color: white !important;">
<code>%Change</code>
</td>
<td style="text-align:left;width: 12em; background-color: white !important;">
<code>% change in proportion between time 1 and time T</code>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
8
</td>
<td style="text-align:left;width: 8em; background-color: white !important;">
<code>%+ve Traj.</code>
</td>
<td style="text-align:left;width: 12em; background-color: white !important;">
<code>% of trajectories with positive slopes</code>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
9
</td>
<td style="text-align:left;width: 8em; background-color: white !important;">
<code>%-ve Traj.</code>
</td>
<td style="text-align:left;width: 12em; background-color: white !important;">
<code>% of trajectories with negative slopes</code>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;border-right:1px solid;">
10
</td>
<td style="text-align:left;width: 8em; background-color: white !important;">
<code>Qtl:1st-4th</code>
</td>
<td style="text-align:left;width: 12em; background-color: white !important;">
<code>Position of a group medoid in the quantile subdivisions</code>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="conclusion" class="section level1">
<h1 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h1>
<p>The <code>akmedoids</code> package has been developed in order to aid the replication of a place-based crime inequality investigation conducted in <span class="citation">Adepeju, Langton, and Bannister (2021)</span>. Meanwhile, the utility of the functions in this package are not limited to criminology, but rather can be applicable to longitudinal datasets more generally. This package is being updated on a regular basis to add more functionalities to the existing <code>functions</code> and add new functions to carry out other longitudinal data analysis.</p>
<p>We encourage users to report any bugs encountered while using the package so that they can be fixed immediately. Welcome contributions to this package which will be acknowledged accordingly.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references hanging-indent">
<div id="ref-Adepeju2021">
<p>Adepeju, M., S. Langton, and J. Bannister. 2021. “Anchored K-Medoids: A Novel Adaptation of K-Medoids Further Refined to Measure Inequality in the Exposure to Crime Across Micro Places.” <em>Journal of Computational Social Science</em>. <a href="https://doi.org/10.1007/s42001-021-00103-1">https://doi.org/10.1007/s42001-021-00103-1</a>.</p>
</div>
<div id="ref-Calinski1974">
<p>Caliński, T., and J. Harabasz. 1974. “A Dendrite Method for Cluster Analysis.” <em>Communications in Statistics-Theory and Methods</em> 3(1): 1–27.</p>
</div>
<div id="ref-Celeux1992">
<p>Celeux, G., and G. Govaert. 1992. “A Classification Em Algorithm for Clustering and Two Stochastic Versions.” <em>Computational Statistics</em> 14(3): 315–32.</p>
</div>
<div id="ref-Genolini2010">
<p>Genolini, C., and B. Falissard. 2010. “Kml and Kml3d: R Packages to Cluster Longitudinal Data.” <em>Computational Statistics</em> 25(2): 317–28.</p>
</div>
<div id="ref-Griffith2004">
<p>Griffith, E., and J. M. Chavez. 2004. “Communities, Street Guns and Homicide Trajectories in Chicago, 1980–1995: Merging Methods for Examining Homicide Trends Across Space and Time.” <em>Criminology</em> 42(4): 941–78.</p>
</div>
<div id="ref-Khan2004">
<p>Khan, S. S, and A. Ahmad. 2004. “Cluster Center Initialization Algorithm for K-Means Clustering.” <em>Pattern Recognition Letters</em> 25(11): 1293–1302.</p>
</div>
<div id="ref-Rousseeuw1987">
<p>Rousseeuw, P. J. 1987. “Silhouettes: A Graphical Aid to the Interpretation and Validation of Cluster Analysis.” <em>Journal of Computational and Applied Mathematics</em>, no. 20: 53–65.</p>
</div>
<div id="ref-Steinley2007">
<p>Steinley, D., and M. J. Brusco. 2007. “Initializing K-Means Batch Clustering: A Critical Evaluation of Several Techniques.” <em>Journal of Classification</em> 24(1): 99–121.</p>
</div>
<div id="ref-Weisburd2004">
<p>Weisburd, D., S. Lum, C. Lum, and S. M. Lum. 2004. “Trajectories of Crime at Places: A Longitudinal Study of Street Segments in the City of Seattle.” <em>Criminology</em> 42(2): 283–322.</p>
</div>
<div id="ref-Wickham2016">
<p>Wickham, H. 2016. <em>Elegant Graphics for Data Analysis</em>. Spring-Verlag New York.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Monsuru Adepeju.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
